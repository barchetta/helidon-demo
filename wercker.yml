box: maven:3.5.4-jdk-9
build:
  steps:
    - script:
      name: build
      code: |
        export MAVEN_OPTS="-Dmaven.repo.local=${WERCKER_CACHE_DIR}/local_repository"
        rm -rf ~/.ssh ${WERCKER_CACHE_DIR}/local_repository/io/helidon/examples/quickstart-se
        mvn clean package
    - internal/docker-build:
      dockerfile: target/Dockerfile
      image-name: helidon-se-demo
    - internal/docker-push:
      image-name: helidon-se-demo
      username: $DOCKER_USER
      password: $DOCKER_PASSWORD
      repository: phx.ocir.io/oraclepaasmicroservices/helidon-se-demo
